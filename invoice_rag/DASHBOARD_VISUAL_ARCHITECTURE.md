# Dashboard Enhancement - Visual Architecture

## System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Telegram Bot                              â”‚
â”‚  (telegram_bot/bot.py)                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ /analysis or /visualizations command
             â”‚ passes user_id
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           get_visualization(user_id=...)                         â”‚
â”‚  (telegram_bot/visualizations.py)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ delegates to
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    create_comprehensive_dashboard(weeks_back, user_id)          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  1. Fetch budget_status (if user_id provided)           â”‚   â”‚
â”‚  â”‚     â†“ check_spending_limit(user_id)                     â”‚   â”‚
â”‚  â”‚  2. Fetch invoice data                                   â”‚   â”‚
â”‚  â”‚     â†“ analyze_invoices(weeks_back)                      â”‚   â”‚
â”‚  â”‚  3. Calculate trends                                     â”‚   â”‚
â”‚  â”‚     â†“ analyze_spending_trends(weeks_back)               â”‚   â”‚
â”‚  â”‚  4. Get transaction types                                â”‚   â”‚
â”‚  â”‚     â†“ analyze_transaction_types(weeks_back)             â”‚   â”‚
â”‚  â”‚  5. Generate visualization                               â”‚   â”‚
â”‚  â”‚     â†“ matplotlib plotting                                â”‚   â”‚
â”‚  â”‚  6. Return BytesIO buffer                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow

```
User Types Command
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Telegram Bot â”‚ â”€â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
                      â”‚ user_id
                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Visualization â”‚
              â”‚    Engine     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚              â”‚              â”‚
       â–¼              â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Budget   â”‚  â”‚   Invoice   â”‚  â”‚  Trend   â”‚
â”‚  Data    â”‚  â”‚    Data     â”‚  â”‚   Data   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚              â”‚              â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Dashboard    â”‚
              â”‚     Image     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ User receives â”‚
              â”‚  visualizationâ”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Dashboard Layout Structure

### Before Enhancement

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸ“Š Analysis Summary                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚Total Spent â”‚  â”‚  Invoices  â”‚  â”‚ Avg Amount â”‚               â”‚
â”‚  â”‚  Rp 2.5M   â”‚  â”‚     45     â”‚  â”‚  Rp 56K    â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                              â”‚                  â”‚
â”‚  Weekly Spending Trend                       â”‚  Top Vendors     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                    â”‚     â”‚  â”‚  Vendor 1  â”‚ â”‚
â”‚  â”‚    [Line Chart]                    â”‚     â”‚  â”‚  Vendor 2  â”‚ â”‚
â”‚  â”‚                                    â”‚     â”‚  â”‚  Vendor 3  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                              â”‚                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   â”‚                                             â”‚
â”‚ Category Dist.    â”‚  Recent Transactions                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚               â”‚ â”‚  â”‚ Date  â”‚ Vendor      â”‚ Amount        â”‚  â”‚
â”‚ â”‚  [Pie Chart]  â”‚ â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚ â”‚               â”‚ â”‚  â”‚ 01/10 â”‚ Tokopedia   â”‚ Rp 250K       â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ 05/10 â”‚ Shopee      â”‚ Rp 180K       â”‚  â”‚
â”‚                   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  ğŸ’¡ Insights: Spending â†‘ 15% | Weekly avg: Rp 2.5M ...        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### After Enhancement

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸ“Š Analysis Summary (Last 8 Weeks)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Total   â”‚ â”‚Invoices  â”‚ â”‚   Avg    â”‚ â”‚ Budget Status   â”‚  â”‚
â”‚  â”‚  Spent   â”‚ â”‚          â”‚ â”‚  Amount  â”‚ â”‚                 â”‚  â”‚
â”‚  â”‚ Rp 2.5M  â”‚ â”‚    45    â”‚ â”‚ Rp 56K   â”‚ â”‚   65% Used ğŸŸ¢   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                   â”‚             â”‚
â”‚  Weekly Spending Trend                            â”‚Top Vendors  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ğŸ“Š INCREASING                            â”‚    â”‚â”‚Vendor 1  â”‚â”‚
â”‚  â”‚ +15%                                     â”‚    â”‚â”‚Vendor 2  â”‚â”‚
â”‚  â”‚                                          â”‚    â”‚â”‚Vendor 3  â”‚â”‚
â”‚  â”‚    [Line Chart with fill]                â”‚    â”‚â”‚Vendor 4  â”‚â”‚
â”‚  â”‚                                          â”‚    â”‚â”‚Vendor 5  â”‚â”‚
â”‚  â”‚    Rp 3M â”€â”€â”€â”€â”€                           â”‚    â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚  â”‚    Rp 2M â”€â”€â”€â”€â”€                           â”‚    â”‚             â”‚
â”‚  â”‚    Rp 1M â”€â”€â”€â”€â”€                           â”‚    â”‚  Rp 1.2M   â”‚
â”‚  â”‚    Rp 0K â”€â”€â”€â”€â”€                           â”‚    â”‚  Rp 850K   â”‚
â”‚  â”‚         W1  W2  W3  W4  W5  W6  W7  W8   â”‚    â”‚  Rp 600K   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  Rp 450K   â”‚
â”‚                                                   â”‚  Rp 300K   â”‚
â”‚                                                   â”‚             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                             â”‚                                   â”‚
â”‚ Category Distribution       â”‚  Recent Transactions              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚                         â”‚ â”‚  â”‚Dateâ”‚Vendor       â”‚Amount    â”‚â”‚
â”‚ â”‚      [Pie Chart]        â”‚ â”‚  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚ â”‚                         â”‚ â”‚  â”‚01/10â”‚Tokopedia   â”‚Rp 250K   â”‚â”‚
â”‚ â”‚  Shopping     40%       â”‚ â”‚  â”‚05/10â”‚Shopee      â”‚Rp 180K   â”‚â”‚
â”‚ â”‚  Food         30%       â”‚ â”‚  â”‚08/10â”‚Grab Food   â”‚Rp 85K    â”‚â”‚
â”‚ â”‚  Transport    20%       â”‚ â”‚  â”‚12/10â”‚Indomaret   â”‚Rp 120K   â”‚â”‚
â”‚ â”‚  Others       10%       â”‚ â”‚  â”‚15/10â”‚Gojek       â”‚Rp 45K    â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                             â”‚                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ ğŸ’¡ Insights: Spending â†‘ 15% | Weekly avg: Rp 2.5M |           â”‚
â”‚   Daily avg: Rp 350K | Budget: 65% used | Top: Tokopedia      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Breakdown

### 1. KPI Cards (Top Row)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Total Spent       â”‚  COLOR: Red (#E74C3C)
â”‚                     â”‚
â”‚     Rp 2.5M         â”‚  FORMAT: format_rp(2500000)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Invoices          â”‚  COLOR: Blue (#3498DB)
â”‚                     â”‚
â”‚       45            â”‚  FORMAT: {count}
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Avg Amount        â”‚  COLOR: Green (#2ECC71)
â”‚                     â”‚
â”‚     Rp 56K          â”‚  FORMAT: format_rp(56000)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Budget Status  ğŸ†•   â”‚  COLOR: Conditional
â”‚                     â”‚    < 80%: Green (#2ECC71)
â”‚   65% Used    ğŸŸ¢    â”‚    80-99%: Orange (#F39C12)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â‰¥100%: Red (#E74C3C)
                           Not Set: Gray (#95A5A6)
```

### 2. Weekly Trend Chart

**With Sufficient Data (â‰¥3 weeks):**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š INCREASING                      â”‚  Trend Badge
â”‚ +15%                               â”‚  (Conditional)
â”‚                                    â”‚
â”‚      â—â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â—          â”‚  Line Chart
â”‚    â—                     â—         â”‚  with markers
â”‚  â—                         â—       â”‚
â”‚                              â—â”€    â”‚  Fill under
â”‚ [Shaded area]                      â”‚
â”‚                                    â”‚
â”‚  W1   W2   W3   W4   W5   W6   W7  W8â”‚
â”‚ (Date Range)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  Y-axis: format_rp values
```

**With Insufficient Data (<3 weeks):**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    â”‚
â”‚  ğŸ“Š More data needed for           â”‚
â”‚     trend analysis                 â”‚
â”‚                                    â”‚
â”‚  Upload more invoices to see       â”‚
â”‚  spending trends over time         â”‚
â”‚                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  [No axes shown]
```

### 3. Budget Status Logic

```python
if user_id is not None:
    budget_status = check_spending_limit(user_id)
    
    if budget_status['has_limit']:
        percentage = budget_status['percentage_used']
        
        if percentage >= 100:
            color = COLOR_BUDGET_OVER    # ğŸ”´ Red
            message = "Over Budget!"
        elif percentage >= 80:
            color = COLOR_BUDGET_WARN    # ğŸŸ¡ Orange
            message = "Approaching Limit"
        else:
            color = COLOR_BUDGET_OK      # ğŸŸ¢ Green
            message = "On Track"
        
        value = f"{percentage:.0f}% Used"
    else:
        color = COLOR_BUDGET_NONE        # âšª Gray
        value = "Not Set"
else:
    # No user context
    color = COLOR_BUDGET_NONE
    value = "Not Set"
```

## Currency Formatting Pipeline

```
Input: 2,500,000
       â”‚
       â–¼
  format_rp(2500000)
       â”‚
       â”œâ”€ Check: >= 1,000,000? â†’ YES
       â”‚    â””â”€ Return: "Rp 2.5M"
       â”‚
       â”œâ”€ Check: >= 1,000? â†’ NO (skipped)
       â”‚
       â””â”€ Check: else â†’ NO (skipped)

Output: "Rp 2.5M"

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Input: 56,000
       â”‚
       â–¼
  format_rp(56000)
       â”‚
       â”œâ”€ Check: >= 1,000,000? â†’ NO
       â”‚
       â”œâ”€ Check: >= 1,000? â†’ YES
       â”‚    â””â”€ Return: "Rp 56K"
       â”‚
       â””â”€ Check: else â†’ NO (skipped)

Output: "Rp 56K"

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Input: 500
       â”‚
       â–¼
  format_rp(500)
       â”‚
       â”œâ”€ Check: >= 1,000,000? â†’ NO
       â”‚
       â”œâ”€ Check: >= 1,000? â†’ NO
       â”‚
       â””â”€ else
            â””â”€ Return: "Rp 500"

Output: "Rp 500"
```

## State Diagram - Dashboard Generation

```
          START
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Check user_id  â”‚
   â”‚ provided?      â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
    â”Œâ”€â”€â”€â”´â”€â”€â”€â”
    â”‚       â”‚
   YES     NO
    â”‚       â”‚
    â–¼       â–¼
â”Œâ”€â”€â”€â”€â”€â”  [Skip budget]
â”‚Fetchâ”‚      â”‚
â”‚Budgetâ”‚     â”‚
â””â”€â”€â”¬â”€â”€â”˜     â”‚
   â”‚        â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
        â”‚
        â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚Fetch Invoiceâ”‚
   â”‚   Data      â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚Create 4 KPIâ”‚
   â”‚   Cards    â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
          â”‚
    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
    â”‚ Budget    â”‚
    â”‚ Card      â”‚
    â”‚ Color?    â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
          â”‚
    â”Œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
    â”‚     â”‚     â”‚     â”‚
  <80%  80-99% â‰¥100% None
    â”‚     â”‚     â”‚     â”‚
   ğŸŸ¢    ğŸŸ¡    ğŸ”´    âšª
    â”‚     â”‚     â”‚     â”‚
    â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚Check Trend  â”‚
   â”‚   Data      â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
          â”‚
    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
    â”‚ Weeks â‰¥ 3?â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
          â”‚
      â”Œâ”€â”€â”€â”´â”€â”€â”€â”
      â”‚       â”‚
     YES     NO
      â”‚       â”‚
      â–¼       â–¼
  [Show   [Show
   Trend]  Message]
      â”‚       â”‚
      â””â”€â”€â”€â”¬â”€â”€â”€â”˜
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚Format All   â”‚
   â”‚Currency     â”‚
   â”‚with format_rpâ”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚Build Insightsâ”‚
   â”‚   Footer    â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Generate   â”‚
   â”‚   PNG       â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
        RETURN
      BytesIO
```

## Color Palette

```
BACKGROUND:
  #EAF2F8 â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ Light Blue-Gray

TITLES:
  #17202A â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ Very Dark Blue
  #2C3E50 â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“ Dark Blue-Gray

KPI CARDS:
  #E74C3C â– â– â– â– â– â– â– â– â– â–  Red (Total Spent)
  #3498DB â– â– â– â– â– â– â– â– â– â–  Blue (Invoices)
  #2ECC71 â– â– â– â– â– â– â– â– â– â–  Green (Avg Amount)

BUDGET STATUS:
  #2ECC71 â—â—â—â—â—â—â—â—â—â— Green (< 80%)
  #F39C12 â—â—â—â—â—â—â—â—â—â— Orange (80-99%)
  #E74C3C â—â—â—â—â—â—â—â—â—â— Red (â‰¥ 100%)
  #95A5A6 â—‹â—‹â—‹â—‹â—‹â—‹â—‹â—‹â—‹â—‹ Gray (Not Set)

TRENDS:
  #8E44AD â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬ Purple (Line)
  #E74C3C â–²â–²â–²â–²â–²â–²â–²â–²â–²â–² Red (Increasing)
  #2ECC71 â–¼â–¼â–¼â–¼â–¼â–¼â–¼â–¼â–¼â–¼ Green (Decreasing)
  #F1C40F â”â”â”â”â”â”â”â”â”â” Yellow (Stable)
```

## File Structure

```
invoice_rag/
â”‚
â”œâ”€â”€ telegram_bot/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ bot.py âœ¨ (Modified)
â”‚   â”‚   â””â”€â”€ Functions:
â”‚   â”‚       â”œâ”€â”€ analysis_command() âœ¨ (passes user_id)
â”‚   â”‚       â””â”€â”€ visualizations_command() âœ¨ (passes user_id)
â”‚   â”‚
â”‚   â”œâ”€â”€ visualizations.py âœ¨ (Major Refactor)
â”‚   â”‚   â””â”€â”€ Functions:
â”‚   â”‚       â”œâ”€â”€ format_rp() ğŸ†• (Helper)
â”‚   â”‚       â”œâ”€â”€ create_comprehensive_dashboard() âœ¨ (Enhanced)
â”‚   â”‚       â”œâ”€â”€ get_visualization() âœ¨ (Updated signature)
â”‚   â”‚       â””â”€â”€ [Other visualization functions]
â”‚   â”‚
â”‚   â””â”€â”€ spending_limits.py
â”‚       â””â”€â”€ Functions:
â”‚           â””â”€â”€ check_spending_limit() (Used by dashboard)
â”‚
â”œâ”€â”€ test_enhanced_dashboard.py ğŸ†• (Test Suite)
â”‚
â”œâ”€â”€ dashboard_output/ ğŸ†• (Test Images)
â”‚   â”œâ”€â”€ test_dashboard_no_user.png
â”‚   â”œâ”€â”€ test_dashboard_user_12345.png
â”‚   â””â”€â”€ test_dashboard_limited_data.png
â”‚
â””â”€â”€ Documentation: ğŸ†•
    â”œâ”€â”€ DASHBOARD_ENHANCEMENT_SUMMARY.md
    â”œâ”€â”€ DASHBOARD_QUICK_GUIDE.md
    â”œâ”€â”€ DASHBOARD_BEFORE_AFTER.md
    â”œâ”€â”€ DASHBOARD_VISUAL_ARCHITECTURE.md (This file)
    â””â”€â”€ README_ENHANCEMENT.md
```

---

**Visual Architecture Complete** âœ…  
**All diagrams showing enhanced dashboard structure** ğŸ“Š
